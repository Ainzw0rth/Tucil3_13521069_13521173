<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Drawing a line with markers and circles using d3.js</title>
  <script src="https://d3js.org/d3.v6.min.js"></script>
  <style>
    .line {
      stroke: black;
      fill: none;
    }
    .circle {
      stroke: black;
      fill: white;
    }
  </style>
</head>
<body>
  <script>
    var svg = d3.select("body")
                .append("svg")
                .attr("width", 500)
                .attr("height", 500);

    var data = [ { x: 50, y: 50, r: 10 }, { x: 100, y: 100, r: 20 }, { x: 150, y: 50, r: 15 }, { x: 200, y: 100, r: 12 } ];

    var line = d3.line()
                 .x(function(d) { return d.x; })
                 .y(function(d) { return d.y; });

    var markerWidth = 8, markerHeight = 8, markerRefX = 12;

    svg.append("path")
       .datum(data)
       .attr("class", "line")
       .attr("d", line)
       .attr("stroke", "black")
       .attr("fill", "none")
       .attr("marker-start", function(d) { return "url(#arrow-start-" + d.r + ")"; })
       .attr("marker-end", function(d) { return "url(#arrow-end-" + d.r + ")"; });

    svg.append("defs")
       .selectAll("marker")
       .data(data)
       .enter()
       .append("marker")
       .attr("id", function(d) { return "arrow-end-" + d.r; })
       .attr("viewBox", "0 -5 10 10")
       .attr("refX", function(d) { return d.r + markerRefX; })
       .attr("refY", 0)
       .attr("markerWidth", markerWidth)
       .attr("markerHeight", markerHeight)
       .attr("orient", "auto")
       .append("path")
       .attr("d", "M10,-5L0,0L10,5")
       .attr("fill", "black");

    svg.selectAll("circle")
       .data(data)
       .enter()
       .append("circle")
       .attr("class", "circle")
       .attr("cx", function(d) { return d.x; })
       .attr("cy", function(d) { return d.y; })
       .attr("r", function(d) { return d.r; });
  </script>
</body>
</html>
